.mainnav {
  position: var(--nav-position, absolute);
  inset-inline-end: 0;
}

.mainnav:has([aria-expanded='true']) {
  --nav-position: fixed;
  inset-inline-end: var(--gap);
}

.mainnav ul {
  --gutter: var(--space-xs-s);
  --cluster-vertical-alignment: normal;
  --cluster-horizontal-alignment: flex-end;
  --nav-list-background: transparent;
  --nav-list-shadow: var(--shadow-soft);
  --nav-list-layout: column;
  --nav-list-height: 100dvh;
  --nav-list-padding: var(--space-xl) var(--space-s);
  --nav-list-position: fixed;
  --nav-list-width: min(18rem, 100vw);
  --nav-list-visibility: hidden;
  --nav-list-opacity: 0;

  background: transparent;
  box-shadow: var(--nav-list-shadow);
  display: flex;
  flex-direction: var(--nav-list-layout);
  flex-wrap: wrap;
  block-size: var(--nav-list-height);
  list-style: none;
  margin: 0;
  padding: var(--nav-list-padding);
  position: var(--nav-list-position);
  inset-block-start: 0;
  inset-inline-end: 0;
  inline-size: var(--nav-list-width);
  opacity: var(--nav-list-opacity);
  transition: opacity var(--transition-duration) var(--transition-timing),
    visibility var(--transition-duration) var(--transition-timing);
  visibility: var(--nav-list-visibility);
  border-inline-start: 1px solid var(--color-border-subtle);
}

.mainnav ul[no-flash] {
  transition: none;
}

@media (prefers-reduced-motion: no-preference) {
  .mainnav ul {
    --nav-list-transform: translateX(100%);
    --nav-list-opacity: 1;
    transform: var(--nav-list-transform);
    transition: transform var(--transition-duration) var(--transition-timing),
      visibility var(--transition-duration) var(--transition-timing);
  }
}

.mainnav [aria-expanded='true'] + ul {
  --nav-list-visibility: visible;
  --nav-list-transform: translateX(0);
  --nav-list-opacity: 1;
}

.mainnav button {
  --gutter: var(--space-2xs);
  --cluster-vertical-alignment: center;
  display: var(--nav-button-display, flex);
  position: relative;
  z-index: 2;
  padding: var(--space-2xs) 0;
  line-height: var(--leading-flat);
}

.mainnav span {
  font-weight: var(--font-bold);
  font-family: var(--font-base);
  font-size: var(--size-step-min-1);
}

.mainnav svg {
  block-size: 0.9em;
  color: var(--color-light);
  stroke-width: 3;
}

.mainnav [aria-expanded='true'] svg {
  transform: rotate(45deg);
}

.mainnav a {
  --nav-item-background: transparent;
  --nav-item-text-color: var(--color-light);
  --nav-item-padding: var(--space-xs) var(--space-2xs);
  --nav-item-decoration-color: color-mix(in oklab, var(--color-light) 45%, transparent);

  background: var(--nav-item-background);
  color: var(--nav-item-text-color);
  padding: var(--nav-item-padding);
  display: block;
  border-radius: var(--radius-soft);
  text-decoration-line: underline;
  text-decoration-color: var(--nav-item-decoration-color);
  text-decoration-thickness: 0.08em;
  text-underline-offset: 0.18em;
}

.mainnav a:where(:hover, :focus-visible) {
  --nav-item-background: color-mix(in oklab, var(--color-dark) 30%, transparent);
  --nav-item-text-color: var(--color-light);
  --nav-item-decoration-color: currentColor;
}

.mainnav [aria-current='page'],
.mainnav [data-state='active'] {
  --nav-item-background: color-mix(in oklab, var(--color-secondary) 22%, transparent);
  --nav-item-text-color: var(--color-light);
  --nav-item-decoration-color: var(--color-light);
}

@media screen(navigation) {
  .mainnav {
    --nav-position: static;
    --nav-button-display: none;
  }

  .mainnav ul {
    --nav-list-layout: row;
    --nav-list-position: static;
    --nav-list-padding: 0;
    --nav-list-height: auto;
    --nav-list-width: 100%;
    --nav-list-shadow: none;
    --nav-list-visibility: visible;
    --nav-list-transform: translateX(0);
    --nav-list-opacity: 1;
    border-inline-start: none;
    background: transparent;
  }

  .mainnav [aria-current='page'],
  .mainnav [data-state='active'] {
    --nav-item-background: color-mix(in oklab, var(--color-secondary) 20%, transparent);
    --nav-item-text-color: var(--color-light);
    --nav-item-decoration-color: currentColor;
  }
}

.mainnav ul:first-child {
  --nav-list-layout: row;
  --nav-list-position: static;
  --nav-list-padding: 0;
  --nav-list-height: auto;
  --nav-list-width: 100%;
  --nav-list-shadow: none;
  --nav-list-visibility: visible;
  --nav-list-transform: translateX(0);
  --nav-list-opacity: 1;
  border-inline-start: none;
  background: transparent;
}

.mainnav ul:first-child [aria-current='page'],
.mainnav ul:first-child [data-state='active'] {
  --nav-item-background: color-mix(in oklab, var(--color-secondary) 20%, transparent);
  --nav-item-text-color: var(--color-light);
  --nav-item-decoration-color: currentColor;
}

.mainnav:has(ul:first-child) {
  --nav-position: relative;
}

@media (prefers-reduced-motion: reduce) {
  .mainnav ul,
  .mainnav [aria-expanded='true'] svg {
    transition: none;
    transform: none;
  }
}
